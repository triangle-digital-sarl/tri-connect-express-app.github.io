# Tri connect express
> Generated by [`prisma-markdown`](https://github.com/samchon/prisma-markdown)

- [Locales](#locales)
- [Users](#users)
- [Operators](#operators)
- [Trips](#trips)
- [Bookings](#bookings)
- [Technical](#technical)

## Locales
![diagram](./db-1.svg)

### `countries`
Country

Every countries that are managed in tri-connect-system.

All Applications should be deployed based on country.
Country is important to determine possible payment methods. 
[bookings.payment_method](#bookings), currencies,
languages and most importantly to find bus, trains or fly.

The Data use for this entity are coming from https://restcountries.com/

**Properties**
  - `name`: Country's name as Primary key
  - `currencies`: 
  - `languages`: 
  - `cca2`
    > Country code ISO 3166-1 alpha-2
    > For Example Cameroon -> CM
  - `cca3`
    > code ISO 3166-1 alpha-3.
    > For Example Cameroon -> CMR
  - `cioc`: code International Olympic Committee
  - `capital`: List of capitals
  - `continent`: 
  - `lat`: 
  - `lng`: 
  - `idd`: 
  - `utc`: 

### `locations`
Locations

`locations` is a entity that represent city, village, canton and all other possible jurical
entities that construct a country.


The Data use for this entity are coming from https://openstreetmap.com/

**Properties**
  - `id`: 
  - `name`: Name of the locations. i.e: citys, village or canton name
  - `postal_code`
    > Represents the postal code of the location. It's marked as optional (String?),
    > indicating that it may not be present for all locations. this is common in some african countries.
  - `lon`
    > This field is of type String (To avoid precision lost) and represents the longitude 
    > coordinate of the location.
  - `lat`
    > This field is of type String (To avoid precision lost) and represents the latitude 
    > coordinate of the location.
  - `abbreviations`: Abbreviations associated with the location. similar to cca2 or cca3 but for locations.
  - `countryName`: 


## Users
![diagram](./db-2.svg)

### `users`
Users can represents:
- the simple user of app, who search bus, purchase ticket and so on.
- the admin user of app, who can persom some administrative tasks
- the operators services

**Properties**
  - `id`: 
  - `first_name`: 
  - `last_name`: 
  - `email`: 
  - `auth_id`
    > Represent auth_id from the autenication.user table from Supabase.
    > So it help link our user with authentication session manage by supabase.
  - `roles`
    > Different role a user can have in our system
    > - PASSENGER
    > - REGISTERED
    > - ADMIN
    > - SUPER_ADMIN
  - `location_id`: 

### `profiles`

**Properties**
  - `id`: 
  - `user_id`: 
  - `profile_picture`: 
  - `preferred_language`: 
  - `settings`: A Json reprensenting User Setting

### `addresses`

**Properties**
  - `id`: 
  - `quarter`: 
  - `lon`: 
  - `lat`: 
  - `bp`: 
  - `city`: 
  - `user_id`: 

### `contacts`

**Properties**
  - `id`: 
  - `type`: 
  - `value`: 
  - `user_id`: 


## Operators
![diagram](./db-3.svg)

### `operators`

**Properties**
  - `id`: 
  - `name`: 
  - `operator_id`: 
  - `headquarter`: 

### `stations`

**Properties**
  - `id`: 
  - `quarter`: 
  - `lon`: 
  - `lat`: 
  - `postal_code`: 
  - `location_id`: 
  - `operator_id`: 


## Trips
![diagram](./db-4.svg)

### `compositions`

**Properties**
  - `id`: 
  - `type`: 
  - `code`: 
  - `operator_id`: 
  - `metas`: 
  - `price`: 
  - `duration`: 
  - `operation_start`: 
  - `operation_end`: 

### `schedules`

**Properties**
  - `id`: 
  - `departure_date`: 
  - `departure_time`: 
  - `trip_id`: 

### `trips`
Trips

Trips is the entry point for searching correspondance

**Properties**
  - `id`: 
  - `composition_id`: 
  - `line_id`: 
  - `departure_station_id`: 
  - `arrival_station_id`: 

### `lines`

**Properties**
  - `id`: 
  - `name`: 
  - `departure_location_id`: 
  - `arrival_location_id`: 
  - `duration`: 


## Bookings
![diagram](./db-5.svg)

### `bookings`

**Properties**
  - `id`: 
  - `payment_method`
    > Payment method. orange money and mtn money are supported
    > @todo(fds): payment method should be enum 
    > ```
    > enum {
    > OM,
    > MOMO,
    > }
    > ```
  - `passengers`: List of passengers as json list
  - `trip_id`: 
  - `departure_date`: 
  - `arrival_date`: 
  - `payee_id`: 
  - `payee_is_passenger`: 
  - `payment_state`: 

### `tickets`

**Properties**
  - `id`: 
  - `ticket_no`: 
  - `qr_code_url`: 
  - `booking_id`: 


## Technical
![diagram](./db-6.svg)

### `feature_flags`

**Properties**
  - `name`: 
  - `value`: 
  - `release_for_roles`: 
  - `release_for_users`: 
  - `release_for_operators`: 
  - `release_for_countries`: 